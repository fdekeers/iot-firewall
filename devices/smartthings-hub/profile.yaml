---
device-info:
  device-name: smartthings-hub
  mac-address: d0:52:a8:72:aa:27
  ip-address: 192.168.1.147
  mud-version: 1
  mud-url: https://smartthings-hub.com/smartthings-hub
  last-update: "2022-03-15T10:27:29.170+01:00"
  cache-validity: 100
  is-supported: true

individual-policies:

  ##### DNS TRAFFIC #####
  dns-ipv4:
    protocols:
      dns:
        qtype: A
        domain-name:
          - api.smartthings.com
          - fw-update2.smartthings.com
      udp:
        dst-port: 53
      ipv4:
        src: self
        dst: gateway
    direction: both

  dns-ipv6:
    protocols:
      dns:
        qtype: AAAA
        domain-name:
          - api.smartthings.com
          - fw-update2.smartthings.com
      udp:
        dst-port: 53
      ipv6:
        src: self
        dst: gateway
    direction: both

  # HTTPS traffic between the hub and the SmartThings cloud
  https-hub-cloud:
    protocols:
      tcp:
        dst-port: 443
      ipv4:
        src: self
        dst: api.smartthings.com
    direction: both
    initiator: src


interaction-policies:

  # Open SmartThings app on mobile phone in local network
  open-app-local:

    igmp-join-coap:
      protocols:
        igmp:
          type: membership report
          group: coap  # 224.0.1.187
        ipv4:
          src: local
          dst: igmpv3  # 224.0.0.22

    # ICMPv6: Multicast Listener Report Message
    # CoAP / IPv6: GET /oic/res?rt=x.com.samsung.provisioninginfo

    coap-multicast-ipv4:
      protocols:
        # TODO: CoAP
        udp:
          dst-port: 5683
        ipv4:
          src: local
          dst: coap
    
    igmp-join-ssdp:
      protocols:
        igmp:
          type: membership report
          group: ssdp  # 239.255.255.250
        ipv4:
          src: local   # Phone running app
          dst: igmpv3  # 224.0.0.22
    
    ssdp-msearch:
      protocols:
        ssdp:
          method: M-SEARCH
        udp:
          dst-port: 1900
        ipv4:
          src: local  # Phone running app
          dst: ssdp   # 239.255.255.250
    

...