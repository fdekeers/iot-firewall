// THIS FILE HAS BEEN AUTOGENERATED. DO NOT EDIT.

/**
 * Nefilter queue for device {{device}} and policy {{policy}}
 */

// Standard libraries
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <pthread.h>
#include <assert.h>
// Custom libraries
#include "nfqueue.h"
#include "packet_utils.h"
// Parsers
#include "parsers/header.h"
{% for custom_parser in custom_parsers %}
#include "parsers/{{custom_parser}}.h"
{% endfor %}

// Constants
#define MAX_THREADS {{max_threads}}
#define NUM_STATES  {{states|length}}
#define NFQ_ID_BASE {{nfq_id_base}}

typedef enum {
{% for state in states %}
    {{state}},
{% endfor %}
} state_t;

state_t state = {{states[0]}};
uint8_t num_threads = 0;
pthread_mutex_t mutex;

